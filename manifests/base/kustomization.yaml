apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
# namespace intentionally removed to avoid conflicts with namespace.yaml

resources:
  - namespace.yaml
  - service-account.yaml
  - deployment.yaml
  - service.yaml
  - client-egress-proxy-demo/namespace.yaml
  - client-egress-proxy-demo/deployment.yaml
  - demo-app/kustomization.yaml

commonLabels:
  app: scaleway-proxy

images:
  - name: ghcr.io/monitob/scaleway-k8s-egres-proxy
    newTag: latest

# This will be overridden in overlays
# configMapGenerator:
#   - name: app-config
#     behavior: merge
#     literals:
#       - APP_ENV=base

secretGenerator:
  - name: app-secrets
    behavior: create
    literals:
      - JWT_SECRET=base-jwt-secret-change-in-production
      - DATABASE_URL=base-database-url
      - QDRANT_API_KEY=base-qdrant-key

configMapGenerator:
  - name: client-egress-config
    behavior: create
    literals:
      - PROXY_ADDRESS=172.16.28.8
      - PROXY_PORT=3128
